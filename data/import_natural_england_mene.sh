#!/bin/bash
set -e; set -u;

INPUTresp=/home/phewson/mene/mene_year_1-9_respondent_data.csv
[[ -f $INPUTresp ]] || { >&2 echo Missing input file: [$INPUTresp] ; exit 5 ; }

cat <<EOF
drop table if exists staging.natural_england_mene_respondents_y1_9;
create unlogged table staging.natural_england_mene_respondents_y1_9 (
 id2 text,
 RespondentID text,
 Interviewdate text,
 WeekWeightANNUAL float,
 MonthWeightANNUAL float,
 QuarterWeightANNUAL float,
 Converted_WeekWeightANNUAL float,
 Converted_MonthWeightANNUAL float,
 Converted_QuarterWeightANNUAL float,
 weekweightCUMULATIVE float,
 monthweightCUMULATIVE float,
 quarterweightCUMULATIVE float,
 LAWeightY4PHOF float,
 LAWeightY1Y3PHOF float,
 LAWeightY1Weekly float,
 LAWeightY2Weekly float,
 LAWeightY3Weekly float,
 LAWeightY4Weekly float,
 LAWeightY5Weekly float,
 LAWeightY6Weekly float,
 LAWeightY7Weekly float,
 LAWeightY1Y7Weekly float,
 LAWeightWeeklyY1Y7Monthly float,
 PHOF text,
 year text,
 q1 text,
 q17 text,
 q18_01 text,
 q18_02 text,
 q18_03 text,
 q18_04 text,
 q18_05 text,
 q18_06 text,
 q18_07 text,
 q18_08 text,
 q18_09 text,
 q18_10 text,
 q18_11 text,
 q18_12 text,
 q18_13 text,
 q18_14 text,
 q18_15 text,
 q18_16 text,
 q18_17 text,
 q18_18 text,
 q18_19 text,
 q18_20 text,
 q18_21 text,
 q18_23 text,
 q18_24 text,
 e2_1 text,
 e2_2 text,
 e2_3 text,
 e2_4 text,
 e3_01 text,
 e3_02 text,
 e3_03 text,
 e3_04 text,
 e3_05 text,
 e3_06 text,
 e3_07 text,
 e3_08 text,
 e3_09 text,
 e3_10 text,
 e4_1 text,
 e4_2 text,
 e4_3 text,
 e4_4 text,
 e4_5 text,
 e4_6 text,
 e4_7 text,
 e4_8 text,
 e4_9 text,
 e4_10 text,
 e4_11 text,
 e4_12 text,
 e5 text,
 e6_01 text,
 e6_02 text,
 e6_03 text,
 e7 text,
 e8_01 text,
 e8_02 text,
 e8_03 text,
 e8_04 text,
 e8_05 text,
 e8_06 text,
 e8_07 text,
 e8_08 text,
 e8_09 text,
 e8_10 text,
 e8_11 text,
 e8_12 text,
 e8_13 text,
 e8_14 text,
 e8_15 text,
 e8_16 text,
 e8_17 text,
 age text,
 sex text,
 ethnicity text,
 disability text,
 marital text,
 workstat text,
 seg text,
 segall text,
 lifestage text,
 physical text,
 adults_in_hh text,
 child_in_hh text,
 nchild_in_hh text,
 hh_size text,
 tenure text,
 workstat5 text,
 car text,
 dog text,
 generalhealth text,
 internetaccess text,
 email text,
 wellbeing1 text,
 q1a text,
 q1b text,
 q1c text,
 q2NEW text,
 RESIDENCE_LOCALAUTHORITY text,
 RESIDENCE_UPPERTIER_LOCALAUTHORITY text,
 RESIDENCE_NCA text,
 RESIDENCE_CONSTITUENCY text,
 RESIDENCE_LOCALACCESSFORUM text,
 RESIDENCE_REGION text,
 RESIDENCE_CEREMONIALCOUNTY text,
 RESIDENCE_NATIONALPARK text,
 RESIDENCE_AONB text,
 RESIDENCE_HERITAGECOAST text,
 RESIDENCE_WHS text,
 RESIDENCE_NIA text,
 RESIDENCE_GREENBELT text,
 RESIDENCE_RURALURBAN text,
 RESIDENCEIMDRANK text,
 RESIDENCE_POSTCODE_SECTOR text,
 primary key(id2, RespondentID));

\copy staging.natural_england_mene_respondents_y1_9 FROM '$INPUTresp' delimiter ',' csv header;

EOF

# id2,RespondentID,Interviewdate,WeekWeightANNUAL,MonthWeightANNUAL,QuarterWeightANNUAL,Converted_WeekWeightANNUAL,Converted_MonthWeightANNUAL,Converted_QuarterWeightANNUAL,weekweightCUMULATIVE,monthweightCUMULATIVE,quarterweightCUMULATIVE,LAWeightY4PHOF,LAWeightY1Y3PHOF,LAWeightY1Weekly,LAWeightY2Weekly,LAWeightY3Weekly,LAWeightY4Weekly,LAWeightY5Weekly,LAWeightY6Weekly,LAWeightY7Weekly,LAWeightY1Y7Weekly,LAWeightWeeklyY1Y7Monthly,PHOF,year,q1,q17,q18_01,q18_02,q18_03,q18_04,q18_05,q18_06,q18_07,q18_08,q18_09,q18_10,q18_11,q18_12,q18_13,q18_14,q18_15,q18_16,q18_17,q18_18,q18_19,q18_20,q18_21,q18_23,q18_24,e2_1,e2_2,e2_3,e2_4,e3_01,e3_02,e3_03,e3_04,e3_05,e3_06,e3_07,e3_08,e3_09,e3_10,e4_1,e4_2,e4_3,e4_4,e4_5,e4_6,e4_7,e4_8,e4_9,e4_10,e4_11,e4_12,e5,e6_01,e6_02,e6_03,e7,e8_01,e8_02,e8_03,e8_04,e8_05,e8_06,e8_07,e8_08,e8_09,e8_10,e8_11,e8_12,e8_13,e8_14,e8_15,e8_16,e8_17,age,sex,ethnicity,disability,marital,workstat,seg,segall,lifestage,physical,adults_in_hh,child_in_hh,nchild_in_hh,hh_size,tenure,workstat5,car,dog,generalhealth,internetaccess,email,wellbeing1,q1a,q1b,q1c,q2NEW,RESIDENCE_LOCALAUTHORITY,RESIDENCE_UPPERTIER_LOCALAUTHORITY,RESIDENCE_NCA,RESIDENCE_CONSTITUENCY,RESIDENCE_LOCALACCESSFORUM,RESIDENCE_REGION,RESIDENCE_CEREMONIALCOUNTY,RESIDENCE_NATIONALPARK,RESIDENCE_AONB,RESIDENCE_HERITAGECOAST,RESIDENCE_WHS,RESIDENCE_NIA,RESIDENCE_GREENBELT,RESIDENCE_RURALURBAN,RESIDENCEIMDRANK,RESIDENCE_POSTCODE_SECTOR
